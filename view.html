// LINE 34, 66, and 74 reqire you to change 0.0.0.0 out with your servers IP. 

<!DOCTYPE html>
<html>

<head>
  <title>iSee View Portal</title>
  <meta charset="utf-8">
  <style>
    body {
      background-color: lightblue;
      font-family: Arial, Helvetica, sans-serif;
    }

    .header {
      text-align: center;
    }

    button {
      background-color: #000;
      color: #fff;
      padding: 10px;
      border: none;
      cursor: pointer;
    }
  </style>
</head>

<body>
  <div class="header">
    <h1>iSee Security Cam Viewer</h1>
  </div>

  <iframe id="myFrame" src="http://0.0.0.0/security/cam.jpg" width="500" height="300"></iframe>

  <script>
    function takeScreenshot() {
      // Get the iframe element.
      var iframe = document.getElementById("myFrame");

      // Create a new canvas element.
      var canvas = document.createElement("canvas");
      canvas.width = iframe.offsetWidth;
      canvas.height = iframe.offsetHeight;

      // Create a 2D context for the canvas.
      var context = canvas.getContext("2d");

      // Draw the iframe content to the canvas.
      context.drawImage(iframe, 0, 0);

      // Get the data URL of the canvas.
      var dataURL = canvas.toDataURL("image/png");

      // Download the canvas as an image.
      var downloadLink = document.createElement("a");
      downloadLink.href = dataURL;
      downloadLink.download = "capture.png";
      downloadLink.click();
    }

    // Get the iframe element
    var frame = document.getElementById("myFrame");

    // Set the initial image URL
    var imgUrl = "http://0.0.0.0/security/cam.jpg";

    // Define the function to refresh the image
    function refreshImage() {
      // Generate a random number to prevent caching
      var cacheBuster = new Date().getTime();

      // Set the new image URL with the cachebuster appended
      imgUrl = "http://0.0.0.0/security/cam.jpg?cache=" + cacheBuster;

      // Set the src attribute of the iframe element with the new URL
      frame.setAttribute("src", imgUrl);
    }

    // Call the refreshImage function every second
    setInterval(refreshImage, 100);
  </script>
</body>

</html>
